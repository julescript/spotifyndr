(this.webpackJsonpspotifyndr=this.webpackJsonpspotifyndr||[]).push([[0],{16:function(e,t,a){e.exports={Landing:"Landing_Landing__1vOQe",leftPane:"Landing_leftPane__1x9Iz",rightPane:"Landing_rightPane__-yZ8x",IconLogo:"Landing_IconLogo__JPSR_",breath:"Landing_breath__2BR55"}},19:function(e,t,a){e.exports={Footer:"Footer_Footer__GZvmW",Container:"Footer_Container__2dBUl",Logo:"Footer_Logo__cgvkU",Copyright:"Footer_Copyright__1iKjX"}},23:function(e,t,a){e.exports={NavBar:"NavBar_NavBar__3JWdI",Account:"NavBar_Account__3PwKk"}},24:function(e,t,a){e.exports={ArtistCard:"ArtistCard_ArtistCard__OuGo2",Spacer:"ArtistCard_Spacer__1VUO8",Info:"ArtistCard_Info__3YDaq"}},25:function(e,t,a){e.exports={Loader:"Spinner_Loader__1twK-",LoaderParent:"Spinner_LoaderParent__3RO6f",light:"Spinner_light__1Esrz",load8:"Spinner_load8__36vjM"}},26:function(e,t,a){e.exports={Albums:"Albums_Albums__17CVc",Header:"Albums_Header__2dE3H",Back:"Albums_Back__1htdx"}},32:function(e,t,a){e.exports={Layout:"Layout_Layout__2BpO9",Children:"Layout_Children__2syKp"}},43:function(e,t,a){e.exports={container:"Container_container__2QYRU"}},44:function(e,t,a){e.exports={LoginCard:"LoginCard_LoginCard__dImu9",enable:"LoginCard_enable__3Idwm"}},45:function(e,t,a){e.exports=a.p+"static/media/logo_icon.da3ea075.svg"},47:function(e,t,a){e.exports={SectionTitle:"SectionTitle_SectionTitle__3quiz"}},48:function(e,t,a){e.exports={Grid:"CardsGrid_Grid__6-8yi",SectionTitle:"CardsGrid_SectionTitle__2XE0A"}},49:function(e,t,a){e.exports={RatingStars:"RatingStars_RatingStars__2DSv8"}},50:function(e,t,a){e.exports=a.p+"static/media/star_filled.765ace4e.svg"},51:function(e,t,a){e.exports=a.p+"static/media/star_empty.21cb713c.svg"},53:function(e,t,a){e.exports={WelcomeText:"WelcomeText_WelcomeText__1HheW"}},54:function(e,t,a){e.exports={AlbumCard:"AlbumCard_AlbumCard__2h8gP"}},55:function(e,t,a){e.exports={BackButton:"BackButton_BackButton__1Gysp"}},56:function(e,t,a){e.exports=a.p+"static/media/back_icon.7a172fc9.svg"},57:function(e,t,a){e.exports=a(87)},66:function(e,t,a){},87:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(20),s=a.n(o),i=a(14),c=a(10),l=a(18),u=a(13),d=function(e,t){return Object(u.a)(Object(u.a)({},e),t)},m=function(e){var t=Math.log10(e)/3|0;if(0===t)return e;var a=["","k","M","G","T","P","E"][t];return(e/Math.pow(10,3*t)).toFixed(1)+a},p=function(e,t){var a;return function(){var n=this,r=arguments;clearTimeout(a),a=setTimeout((function(){return e.apply(n,r)}),t)}},h=function(){return document.documentElement.scrollHeight-document.documentElement.scrollTop<=document.documentElement.clientHeight+80},f={AUTH_TOKEN:null,USER:null,IS_AUTHORIZED:!1},E=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:f,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"ADD_AUTH":return d(e,{AUTH_TOKEN:t.token});case"DELETE_AUTH":return d(e,{AUTH_TOKEN:null});case"ADD_USER":return d(e,{USER:t.user,IS_AUTHORIZED:!0});case"DELETE_USER":return d(e,{USER:null,IS_AUTHORIZED:!1});default:return e}},_={SEARCH_RESULTS:null,SEARCH_QUERY:"",loading:!1},g=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:_,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"UPDATE_SARCH":return d(e,{SEARCH_RESULTS:t.data});case"UPDATE_QUERY":return d(e,{SEARCH_QUERY:t.data});case"SET_LOADING":return d(e,{loading:t.value});default:return e}},b=(a(66),a(8)),v=a(9),y=a(12),k=a(11),S=a(2),R=a(16),A=a.n(R),U=a(43),C=a.n(U),O=function(e){return r.a.createElement("div",{className:e.className+" "+C.a.container},e.children)},T=a(44),L=a.n(T),N=function(e){return r.a.createElement("div",{className:L.a.LoginCard},r.a.createElement("h3",null,"Get started"),r.a.createElement("button",{onClick:e.onClick},"Login with Spotify"))},B=a(45),j=a.n(B),w=function(e){return r.a.createElement("img",{src:j.a,alt:"Spotifyndr logo",className:e.className})},x=function(e){Object(y.a)(a,e);var t=Object(k.a)(a);function a(){var e;Object(b.a)(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).loginWithSpotifyHandler=function(){var e="https://accounts.spotify.com/authorize";e+="?response_type=token",e+="&client_id="+encodeURIComponent("ca352bf1c0ea43b58b0e20abba160090"),e+="&scope="+encodeURIComponent("user-read-private user-read-email"),e+="&redirect_uri=https://julescript.github.io/spotifyndr",window.location=e},e}return Object(v.a)(a,[{key:"render",value:function(){return r.a.createElement("div",{className:A.a.Landing},r.a.createElement(O,{className:A.a.Landing},r.a.createElement("div",{className:A.a.leftPane},r.a.createElement("h1",null,"find",r.a.createElement("br",null),"your",r.a.createElement("br",null),"artists"),r.a.createElement(w,{className:A.a.IconLogo})),r.a.createElement("div",{className:A.a.rightPane},r.a.createElement(N,{onClick:this.loginWithSpotifyHandler}))))}}]),a}(n.Component),H=Object(c.b)((function(e){return{user:e.authReducer.USER}}),(function(e){return{setToken:function(t){return e({type:"ADD_AUTH",token:t})},setUser:function(t){return e({type:"ADD_USER",user:t})}}}))(Object(S.h)(x)),D=a(22),I=a(23),P=a.n(I),F=a(46),G=function(e){Object(y.a)(a,e);var t=Object(k.a)(a);function a(){return Object(b.a)(this,a),t.apply(this,arguments)}return Object(v.a)(a,[{key:"render",value:function(){return r.a.createElement("div",{className:P.a.NavBar},r.a.createElement(w,null),r.a.createElement(F.DebounceInput,{minLength:3,debounceTimeout:300,onChange:this.props.onChange,placeholder:"Search Spotify artists",type:"search",disabled:!this.props.user}),this.props.user?r.a.createElement("div",{className:P.a.Account},r.a.createElement("div",null,this.props.user.display_name),r.a.createElement("img",{src:null,alt:""})):r.a.createElement("div",{className:P.a.Account},r.a.createElement("div",null,"Loading"),r.a.createElement("img",{src:null,alt:""})))}}]),a}(n.Component),W=a(47),Q=a.n(W),q=function(e){return r.a.createElement("div",{className:e.className+" "+Q.a.SectionTitle},r.a.createElement("h1",null,e.title),r.a.createElement("h2",null,e.subtitle))},K=a(48),M=a.n(K),z=function(e){return r.a.createElement("div",{className:M.a.Grid},e.children)},Y=a(24),Z=a.n(Y),J=a(49),V=a.n(J),X=a(50),$=a.n(X),ee=a(51),te=a.n(ee),ae=function(e){var t=Math.round(parseFloat(e.rating));t>5?t=5:t<0&&(t=0);for(var a=[0,0,0,0,0],n=0;n<t;n++)a[n]=1;var o=a.map((function(e,t){return 0===e?r.a.createElement("img",{key:t,src:te.a,alt:"Empty Star"}):r.a.createElement("img",{key:t,src:$.a,alt:"Filled Star"})}));return r.a.createElement("div",{className:V.a.RatingStars},o)},ne=function(e){return r.a.createElement("div",{className:Z.a.ArtistCard,style:{backgroundImage:"url("+e.img+")"},onClick:e.onClick},r.a.createElement("div",{className:Z.a.Spacer}),r.a.createElement("div",{className:Z.a.Info},r.a.createElement("h3",null,e.name),r.a.createElement("p",null,(t=e.followers)>1?m(t)+" followers":1===t?m(t)+" follower":"No followers"),r.a.createElement(ae,{rating:e.stars})));var t},re=a(52),oe=a.n(re).a.create({baseURL:"https://api.spotify.com/v1",headers:{"content-type":"application/json",Accept:"application/json"}});var se=oe,ie=a(53),ce=a.n(ie),le=function(e){return r.a.createElement("div",{className:ce.a.WelcomeText},r.a.createElement("h1",null,e.name,","),r.a.createElement("h2",null,"Welcome to Spotifyndr"),r.a.createElement("hr",null),r.a.createElement("h3",null,"Simply start by typing your desired artist in the search bar"))},ue=a(25),de=a.n(ue),me=function(e){var t=[de.a.LoaderParent];return e.light&&t.push(de.a.light),r.a.createElement("div",{className:t.join(" ")},r.a.createElement("div",{className:de.a.Loader},"Loading ..."))},pe=function(e){Object(y.a)(a,e);var t=Object(k.a)(a);function a(){var e;Object(b.a)(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={searchResults:null,searchQuery:"",loading:!1,error:!1,didReachBottom:!1},e.handleSearch=function(t){var a=t.target.value;e.setState({searchQuery:a}),e.performSearch(a)},e.ArtistClickedHandler=function(t){e.props.history.push({pathname:"/artists/"+t+"/albums"})},e}return Object(v.a)(a,[{key:"componentDidMount",value:function(){var e=this;window.addEventListener("scroll",p((function(){h()&&e.setState({didReachBottom:!0})}),100))}},{key:"componentDidUpdate",value:function(e,t){t.didReachBottom!==this.state.didReachBottom&&!1===t.didReachBottom&&this.props.results&&(this.props.results.items.length<this.props.results.total&&this.props.results.items.length>this.props.results.offset?this.fetchNext():console.log("limit reached no more requests"))}},{key:"fetchNext",value:function(){var e=this;this.setState({loading:!0,error:!1}),this.props.onLoadingUpdated(!0),se.get(this.props.results.next,{headers:{Authorization:"Bearer "+this.props.token}}).then((function(t){var a,n=Object(u.a)({},t.data.artists),r=Object(u.a)({},e.props.results);(a=n.items).unshift.apply(a,Object(D.a)(r.items)),e.setState({searchResults:n,loading:!1,error:!1,didReachBottom:!1}),e.props.onResultsUpdated(n),e.props.onLoadingUpdated(!1)})).catch((function(t){e.setState({loading:!1,error:t.response,didReachBottom:!0}),e.props.onLoadingUpdated(!1),console.log(t)}))}},{key:"performSearch",value:function(e){var t=this;this.setState({loading:!0,error:!1,didReachBottom:!1}),this.props.onQueryUpdated(e),this.props.onLoadingUpdated(!0),se.get("/search/",{headers:{Authorization:"Bearer "+this.props.token},params:{q:e,type:"artist",limit:12}}).then((function(e){t.setState({searchResults:e.data.artists,loading:!1,error:!1}),t.props.onResultsUpdated(e.data.artists),t.props.onLoadingUpdated(!1)})).catch((function(e){t.setState({loading:!1,error:e.response}),t.props.onLoadingUpdated(!1)}))}},{key:"render",value:function(){var e=this,t=null;return this.props.results&&(t=this.props.results.items.map((function(t){return r.a.createElement(ne,{img:t.images[1]?t.images[1].url:null,name:t.name,followers:t.followers.total,stars:t.popularity/20,key:t.id,onClick:function(){return e.ArtistClickedHandler(t.id)}})}))),this.props.loading&&!this.props.results&&(t=r.a.createElement(me,null)),r.a.createElement(O,null,r.a.createElement(G,{onChange:this.handleSearch,user:this.props.user,query:this.props.query}),""!==this.props.query?r.a.createElement(r.a.Fragment,null,r.a.createElement(q,{title:"Artists",subtitle:"Showing results for \u201c"+this.props.query+'"'}),!this.props.loading||this.props.results?r.a.createElement(z,null,t):t,this.props.loading&&this.props.results?r.a.createElement(me,null):null):r.a.createElement(le,{name:this.props.user?this.props.user.display_name:"Hello"}))}}]),a}(n.Component),he=Object(c.b)((function(e){return{user:e.authReducer.USER,token:e.authReducer.AUTH_TOKEN,results:e.searchReducer.SEARCH_RESULTS,query:e.searchReducer.SEARCH_QUERY,loading:e.searchReducer.loading}}),(function(e){return{onResultsUpdated:function(t){return e({type:"UPDATE_SARCH",data:t})},onQueryUpdated:function(t){return e({type:"UPDATE_QUERY",data:t})},onLoadingUpdated:function(t){return e({type:"SET_LOADING",value:t})}}}))(Object(S.h)(pe)),fe=a(26),Ee=a.n(fe),_e=a(54),ge=a.n(_e),be=function(e){return r.a.createElement("div",{className:ge.a.AlbumCard},r.a.createElement("div",{style:{backgroundImage:"url("+e.img+")"}},r.a.createElement("button",{onClick:e.onClick,disabled:e.disabled},"Preview on Spotify")),r.a.createElement("h3",null,e.name),r.a.createElement("h4",null,e.date+" \xb7 "+((t=e.tracks)>1?t+" tracks":1===t?t+" track":"No tracks")));var t},ve=a(55),ye=a.n(ve),ke=a(56),Se=a.n(ke),Re=function(e){return r.a.createElement("div",{className:ye.a.BackButton,onClick:e.onClick},r.a.createElement("img",{src:Se.a,alt:""}),r.a.createElement("div",null,"Back"))},Ae=function(e){Object(y.a)(a,e);var t=Object(k.a)(a);function a(){var e;Object(b.a)(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={albums:null,loading:!0,error:!1,didReachBottom:!1},e.backButtonHandler=function(){e.props.history.goBack()},e.previewButtonClickedHandler=function(e){window.open(e,"_blank")},e}return Object(v.a)(a,[{key:"componentDidMount",value:function(){var e=this;window.addEventListener("scroll",p((function(){h()&&e.setState({didReachBottom:!0})}),100)),this.fetchFirst()}},{key:"fetchFirst",value:function(){var e=this;se.get(this.props.match.url+"/",{headers:{Authorization:"Bearer "+this.props.token},params:{limit:12}}).then((function(t){e.setState({albums:t.data,loading:!1,error:!1,didReachBottom:!1})})).catch((function(t){e.setState({albums:null,loading:!1,error:t.response,didReachBottom:!0})}))}},{key:"componentDidUpdate",value:function(e,t){t.didReachBottom!==this.state.didReachBottom&&!1===t.didReachBottom&&this.state.albums&&(this.state.albums.items.length<this.state.albums.total&&this.state.albums.items.length>this.state.albums.offset?this.fetchNext():console.log("limit reached no more requests"))}},{key:"fetchNext",value:function(){var e=this;this.setState({loading:!0,error:!1}),se.get(this.state.albums.next,{headers:{Authorization:"Bearer "+this.props.token}}).then((function(t){var a,n=Object(u.a)({},t.data),r=Object(u.a)({},e.state.albums);(a=n.items).unshift.apply(a,Object(D.a)(r.items)),e.setState({albums:n,loading:!1,error:!1,didReachBottom:!1})})).catch((function(t){e.setState({loading:!1,error:t.response,didReachBottom:!0}),console.log(t)}))}},{key:"render",value:function(){var e=this,t=null;return this.state.albums&&(t=this.state.albums.items.map((function(t){return r.a.createElement(be,{key:t.id,img:t.images[1]?t.images[1].url:null,name:t.name,date:t.release_date.substring(0,4),tracks:t.total_tracks,onClick:function(){return e.previewButtonClickedHandler(t.external_urls.spotify)},disabled:!1})}))),this.state.loading&&!this.state.albums&&(t=r.a.createElement(me,null)),r.a.createElement(O,{className:Ee.a.Albums},r.a.createElement("div",{className:Ee.a.Header},r.a.createElement(q,{title:this.state.albums?this.state.albums.items[0].artists[0].name:"Artist",subtitle:"Albums"}),r.a.createElement("div",{className:Ee.a.Back},r.a.createElement(Re,{onClick:this.backButtonHandler}))),!this.state.loading||this.state.albums?r.a.createElement(z,null,t):t,this.state.loading&&this.state.albums?r.a.createElement(me,null):null)}}]),a}(n.Component),Ue=Object(c.b)((function(e){return{token:e.authReducer.AUTH_TOKEN}}),(function(e){return{}}))(Object(S.h)(Ae)),Ce=a(32),Oe=a.n(Ce),Te=a(19),Le=a.n(Te),Ne=function(e){return r.a.createElement("div",{className:Le.a.Footer},r.a.createElement(O,{className:Le.a.Container},r.a.createElement("div",{className:Le.a.Logo},"Spotifyndr"),r.a.createElement("div",{className:Le.a.Copyright},"Made with ",r.a.createElement("span",{role:"img","aria-label":"heart emoji"},"\u2764\ufe0f")," by ",r.a.createElement("a",{href:"https://github.com/julescript",rel:"noopener noreferrer",target:"_blank"},"julescript"))))},Be=function(e){return r.a.createElement("div",{className:Oe.a.Layout},r.a.createElement("div",{className:Oe.a.Children},e.children),r.a.createElement(Ne,null))},je=function(e){Object(y.a)(a,e);var t=Object(k.a)(a);function a(){var e;Object(b.a)(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={is_auth:!1,loading:!0},e.fetchUser=function(){se.get("/me/",{headers:{Authorization:"Bearer "+e.props.token}}).then((function(t){e.props.setUser(t.data),e.setState({is_auth:!0,loading:!1})})).catch((function(t){e.props.delToken(),e.setState({is_auth:!1,loading:!1})}))},e}return Object(v.a)(a,[{key:"componentDidMount",value:function(){var e=window.location.hash.substring(1).split("&").reduce((function(e,t){if(t){var a=t.split("=");e[a[0]]=decodeURIComponent(a[1])}return e}),{})["/access_token"];e&&this.props.setToken(e)}},{key:"render",value:function(){return this.props.token?(!this.state.is_auth&&this.props.token&&this.fetchUser(),r.a.createElement(Be,null,r.a.createElement(S.d,null,r.a.createElement(S.b,{path:"/",exact:!0,component:he}),r.a.createElement(S.b,{path:"/artists/:id/albums",exact:!0,component:Ue}),r.a.createElement(S.b,{exact:!0,path:"/artists/:id",render:function(){return r.a.createElement(S.a,{to:"/"})}}),r.a.createElement(S.b,{exact:!0,path:"/artists",render:function(){return r.a.createElement(S.a,{to:"/"})}}),r.a.createElement(S.b,{exact:!0,path:"/:access_token",render:function(){return r.a.createElement(S.a,{to:"/"})}})))):r.a.createElement(S.d,null,r.a.createElement(S.b,{path:"/",exact:!0,component:H}))}}]),a}(n.Component),we=Object(c.b)((function(e){return{token:e.authReducer.AUTH_TOKEN,user:e.authReducer.USER,is_auth:e.authReducer.IS_AUTHORIZED}}),(function(e){return{delToken:function(){return e({type:"DELETE_AUTH"})},setToken:function(t){return e({type:"ADD_AUTH",token:t})},setUser:function(t){return e({type:"ADD_USER",user:t})}}}))(je);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function xe(){var e=Object(S.g)().pathname;return Object(n.useEffect)((function(){window.scrollTo(0,0)}),[e]),null}var He=Object(l.b)({authReducer:E,searchReducer:g}),De=Object(l.c)(He);s.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(c.a,{store:De},r.a.createElement(i.a,{basename:"/"},r.a.createElement(xe,null),r.a.createElement(we,null)))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[57,1,2]]]);
//# sourceMappingURL=main.b9822942.chunk.js.map